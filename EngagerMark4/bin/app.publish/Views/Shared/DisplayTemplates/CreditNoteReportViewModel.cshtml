@model EngagerMark4.ApplicationCore.ReportViewModels.CreditNoteReportViewModel


@{ 
    int currentIndex = 0;
    int maxRecord = 34;
    int currentRecord = 1;
}

<html>
<head>
    <meta charset="utf-8" />
    <title>Purchase Order</title>
    <style>
        .invoice-box {
            max-width: 695px;
            width: 695px;
            height: 1000px;
            max-height: 1000px;
            margin: auto;
            border: 1px solid black;
            box-shadow: 0 0 10px rgba(0, 0, 0, .15);
            font-size: 11px;
        }
    </style>
</head>
<body style="font-family:Tahoma;font-size:11px;">
    @do
    {
        <div class="invoice-box">
            <div style="margin:5px;margin-right:5px;">
                <img src="@Url.Action(Model.HeaderLogo, "Images\\Company", null, Request.Url.Scheme)" style="width:680px;" />
            </div>
            <table style="font-family:Tahoma;font-size:11px;">
                <tr style="height:80px;">
                    <td style="width:390px;vertical-align:top;">
                        <table style="font-family:Tahoma;font-size:11px;">
                            <tr>
                                <td style="width:90px;vertical-align:top;"><label style="margin-left:5px;"> <b>MESSRS :</b> </label></td>
                                <td>
                                    @if (Model.needsVesselNameInFrontCompanyName)
                                    {
                                        <span>Master/Owner "@Model.Vessel"</span>
                                        <br />
                                        <span>c/o</span>
                                    }
                                    @Model.Customer
                                    <br />
                                    @Model.Address
                                </td>
                            </tr>
                        </table>
                    </td>
                    <td style="width:390px;vertical-align:top;">
                        <table style="font-family:Tahoma;font-size:11px;">
                            <tr>
                                <td style="width:200px;text-align:right;">
                                    <b>CN NO: </b>
                                </td>
                                <td>
                                    <label style="margin-left:10px;">
                                        @Model.CNNo
                                    </label>
                                </td>
                                
                            </tr>
                            <tr>
                                <td style="text-align:right;">
                                    <b>DATE: </b>
                                </td>
                                <td>
                                    <label style="margin-left:10px;">
                                        @Model.DateStr
                                    </label>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>
            <table style="font-size:11px;font-family:Tahoma;border-collapse:collapse;height:765px;">
                <thead>
                    <tr style="border-bottom:1px solid black;height:30px;background-color:silver;border-top:1px solid black;">
                        <td style="text-align:center;width:80px;border-right:1px solid black;">
                            Date
                        </td>
                        <td style="text-align:center;width:480px;border-right:1px solid black;">
                            Particulars
                        </td>
                        <td style="text-align:center;width:140px;">
                            Amount (SGD)
                        </td>
                        
                    </tr>
                </thead>
                <tbody >
                    <tr style="height:25px;border-bottom:1px solid black;">
                        <td style="text-align:center;width:80px;border-right:1px solid black;">
                        </td>
                        <td style="text-align:center;width:480px;border-right:1px solid black;">
                            <b>"@Model.Vessel"</b>
                        </td>
                        <td style="text-align:center;width:140px;">
                        </td>
                    </tr>
                    @while(currentIndex < Model.Details.Count)
                    {
                        if(currentRecord> maxRecord)
                        {
                            currentRecord = 0;
                            break;
                        }
                        if (Model.Details[currentIndex].IsHeader)
                        {
                            <tr style="height:30px;vertical-align:bottom;">
                                <td style="text-align:center;width:80px;border-right:1px solid black;text-align:left;"><label style="margin-left:5px;"> </label></td>
                                <td style="text-align:center;width:480px;border-right:1px solid black;text-align:left;"><label style="margin-left:5px;"> @Model.Details[currentIndex].Description</label></td>
                                <td style="text-align:center;width:140px;"></td>
                            </tr>
                        }
                        else
                        {
                            <tr style="height:10px;">
                                <td style="width:80px;border-right:1px solid black;text-align:left;"><label style="margin-left:5px;"></label></td>
                                <td style="width:480px;border-right:1px solid black;text-align:left;"><label style="margin-left:5px;"> @Model.Details[currentIndex].Description</label></td>
                                <td style="width:140px;text-align:right;"><label style="margin-right:5px;"> @Model.Details[currentIndex].TotalAmount</label></td>
                            </tr>
                        }
                        currentIndex++;
                        currentRecord++;
                    }
                    <tr>
                        <td style="text-align:center;width:80px;border-right:1px solid black;"></td>
                        <td style="text-align:center;width:480px;border-right:1px solid black;">
                        </td>
                        <td style="text-align:center;width:140px;"></td>
                    </tr>
                    
                    <tr style="height:25px;">
                        <td style="border-top:1px solid black;"></td>
                        @if (Model.IsTaxCN)
                        {
                            <td style="border-left:1px solid black;border-top:1px solid black;border-right:1px solid black;text-align:right;"><label style="margin-right:5px;"><b>Total Taxable Amount</b></label></td>

                        }
                        else
                        {
                            <td style="border-left:1px solid black;border-top:1px solid black;border-right:1px solid black;text-align:right;"><label style="margin-right:5px;"><b>Grand Total</b></label></td>

                        }
                        <td style="border-top:1px solid black;text-align:right;margin-right:5px;"><label style="margin-right:5px;"> @Model.TotalAmount</label></td>
                    </tr>
                    @if (Model.IsTaxCN)
                    {
                    <tr style="height:25px;">
                        <td ></td>
                        <td  style="text-align:right;border-left:1px solid black;border-top:1px solid black;border-right:1px solid black;"><label style="margin-right:5px;"><b>Add @Model.TaxDescription % GST on * @Model.TotalAmount </b></label></td>
                        <td style="border-top:1px solid black;text-align:right;margin-right:5px;"><label style="margin-right:5px;"> @Model.TaxAmount</label></td>
                    </tr>
                    <tr style="height:25px;">
                        <td></td>
                        <td  style="text-align:right;border-left:1px solid black;border-top:1px solid black;border-right:1px solid black;"><label style="margin-right:5px;"><b>Grand Total </b></label></td>
                        <td style="border-top:1px solid black;text-align:right;"><label style="margin-right:5px;"> @Model.GrandTotal</label></td>
                    </tr>
                    }
                </tbody>
            </table>
            <div style="width:690px;text-align:center;padding-bottom:10px;font-family:Tahoma;margin-top:5px;">
                <label style="margin-top:5px;"><b>THIS IS THE COMPUTER GENERATED PRINTOUT. NO SIGNATURE IS REQUIRED.</b></label>
            </div>
        </div>
    } while (currentIndex < Model.Details.Count);
</body>
</html>