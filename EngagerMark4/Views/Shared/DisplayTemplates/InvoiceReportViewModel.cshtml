@model EngagerMark4.ApplicationCore.ReportViewModels.InvoiceReportViewModel

@{ #line 2 "D:\Workspace\Dummy_Web\EngagerMark4\Views\Shared\DisplayTemplates\InvoiceReportViewModel.cshtml"
    /**/

    int currentIndex = 0;
    int maxRecord = 34;
    int currentRecord = 1;
}

<html>
<head>
    <meta charset="utf-8" />
    <title>Purchase Order</title>
    <style>
        .invoice-box {
            max-width: 695px;
            width: 695px;
            height: 1014px;
            max-height: 1014px;
            margin: auto;
            border: 1px solid black;
            box-shadow: 0 0 10px rgba(0, 0, 0, .15);
            font-size: 11px;
        }
    </style>
</head>
<body style="font-family:Tahoma;font-size:11px;">
    @do
        {
            Model.CurrentPage++;
            <div class="invoice-box">
                <div style="margin:5px;margin-right:5px;">
                    <img src="@Url.Action(Model.HeaderLogo, "Images\\Company", null, Request.Url.Scheme)" style="width:680px;" />
                </div>
                <table style="font-family:Tahoma;font-size:11px;">
                    <tr style="height:80px;">
                        <td style="width:390px;vertical-align:top;">
                            <table style="font-family:Tahoma;font-size:11px;">
                                <tr>
                                    <td style="width:90px;vertical-align:top;"><label style="margin-left:5px;"> <b>MESSRS :</b> </label></td>
                                    <td>
                                        @if (Model.needsVesselNameInFrontCompanyName)
                                        {
                                            <span>Master/Owner "@Model.Vessel"</span>
                                            <br />
                                            <span>c/o</span>
                                        }
                                        @Model.Customer
                                        <br />
                                        @Model.Address
                                        @if(!string.IsNullOrEmpty(Model.AttnStr))
                                        {
                                            <br />
                                            <span>Attn : </span> @Model.AttnStr
                                        }

                                    </td>
                                </tr>
                            </table>
                        </td>
                        <td style="width:390px;vertical-align:top;">
                            <table style="font-family:Tahoma;font-size:11px;">
                                <tr>
                                    <td style="width:200px;text-align:right;">
                                        <b>TAX INVOICE NO: </b>
                                    </td>
                                    <td>
                                        <label style="margin-left:10px;">
                                            @Model.InvoiceNo
                                        </label>
                                    </td>

                                </tr>
                                <tr>
                                    <td style="text-align:right;">
                                        <b>DATE: </b>
                                    </td>
                                    <td>
                                        <label style="margin-left:10px;">
                                            @Model.DateStr
                                        </label>
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </table>
                <table style="font-size:11px;font-family:Tahoma;height:777px;border-collapse:collapse;">
                    <thead>
                        <tr style="border-bottom:1px solid black;height:30px;background-color:silver;border-top:1px solid black;">
                            <td style="text-align:center;width:80px;border-right:1px solid black;">
                                Date
                            </td>
                            <td colspan="3" style="text-align:center;width:480px;border-right:1px solid black;">
                                Particulars
                            </td>
                            <!-- <td style="text-align:center;width:70px;border-right:1px solid black;">
                                Qty
                            </td>
                            <td style="text-align:center;width:100px;border-right:1px solid black;">
                                Price
                            </td>-->
                            <td style="text-align:center;width:140px;">
                                Amount (SGD)
                            </td>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style="height:25px;border-bottom:1px solid black;">
                            <td style="text-align:center;width:80px;border-right:1px solid black;"></td>
                            <td colspan="3" style="text-align:center;width:480px;border-right:1px solid black;">
                                <b> "@Model.Vessel" </b>
                            </td>
                            <!--<td style="text-align:center;width:70px;border-right:1px solid black;">
                            </td>
                            <td style="text-align:center;width:100px;border-right:1px solid black;">
                            </td>-->
                            <td style="text-align:center;width:140px;"></td>
                        </tr>
                        @while (currentIndex < Model.Details.Count())
                        {
                            if (currentRecord > Model.GetMaxRecord())
                            {
                                currentRecord = 0;
                                break;
                            }
                            if (Model.Details[currentIndex].IsHeader)
                            {
                                currentRecord++;
                                <tr style="height:10px;">
                                    <td style="width:80px;border-right:1px solid black;text-align:left;"><label style="margin-left:5px;"></label></td>
                                    <td style="width:480px;border-right:1px solid black;text-align:left;" colspan="3"><label style="margin-left:5px;"></label></td>
                                    <td style="width:140px;text-align:right;"></td>
                                </tr>
                                <tr style="height:10px;vertical-align:bottom;">
                                    <td style="text-align:center;width:80px;border-right:1px solid black;text-align:left;">
                                        @if (Model.Details[currentIndex].IsDNNo == false)
                                        {
                                            <label style="margin-left:5px;"> @Model.Details[currentIndex].InvoiceDateStr</label>
                                        }
                                    </td>
                                    <td colspan="3" style="text-align:center;width:480px;border-right:1px solid black;text-align:left;"><label style="margin-left:5px;"> @Model.Details[currentIndex].WorkOrderNo</label></td>
                                    <!--<td style="text-align:center;width:70px;border-right:1px solid black;"></td>
                                    <td style="text-align:center;width:100px;border-right:1px solid black;"></td>-->
                                    <td style="text-align:center;width:140px;"></td>
                                </tr>
                            }
                            else
                            {
                                <tr style="height:10px;">
                                    <td style="width:80px;border-right:1px solid black;text-align:left;"><label style="margin-left:5px;"></label></td>
                                    <td style="width:480px;border-right:1px solid black;text-align:left;" colspan="3"><label style="margin-left:5px;"> @Model.Details[currentIndex].DisplayDescription</label></td>
                                    @if(Model.Details[currentIndex].DisplayDescription.Length > 89)
                                    {
                                        currentRecord++;
                                    }

                                    <!--<td style="width:70px;border-right:1px solid black;text-align:right;"><label style="margin-right:5px;"> @Model.Details[currentIndex].Qty</label></td>
                                    <td style="width:100px;border-right:1px solid black;text-align:right;"><label style="margin-right:5px;"> @Model.Details[currentIndex].Price</label></td>-->
                                    <td style="width:140px;text-align:right;">
                                        <label style="margin-right:5px;"> @Model.Details[currentIndex].TotalAmount</label>
                                        @if (Model.Details[currentIndex].IsTaxable && Model.IsTaxInvoice)
                                        {
                                            <label>*</label>
                                        }
                                        else
                                        {
                                            <label>&nbsp;</label>
                                        }
                                    </td>
                                </tr>
                            }

                            if (!string.IsNullOrEmpty(Model.Details[currentIndex].Description))
                            {
                                <tr style="height:10px;">
                                    <td style="width:80px;border-right:1px solid black;text-align:left;"><label style="margin-left:5px;"></label></td>
                                    <td style="width:480px;border-right:1px solid black;text-align:left;" colspan="3"><label style="margin-left:5px;"> (@Model.Details[currentIndex].Description)</label></td>
                                </tr>
                                currentRecord++;
                            }
                            currentIndex++;
                            currentRecord++;
                        }
                        <tr>
                            <td style="text-align:center;width:80px;border-right:1px solid black;"></td>
                            <td style="text-align:center;width:480px;border-right:1px solid black;" colspan="3"></td>
                            <!--<td style="text-align:center;width:70px;border-right:1px solid black;"></td>
                            <td style="text-align:center;width:100px;border-right:1px solid black;"></td>-->
                            <td style="text-align:center;width:140px;"></td>
                        </tr>
                        @if (Model.IsLastPage)
                        {
                            if (Model.IsTaxInvoice)
                            {
                                <tr style="height:25px;">
                                    <td style="border-top:1px solid black;"> </td>
                                    <td style="border-top:1px solid black;"></td>
                                    <td colspan="2" style="border-left:1px solid black;border-top:1px solid black;border-right:1px solid black;"><label style="margin-left:5px;"><b>Total Taxable Amount</b></label></td>
                                    <td style="border-top:1px solid black;text-align:right;margin-right:5px;"><label style="margin-right:5px;"> @Model.TotalAmount</label></td>
                                </tr>
                                <tr style="height:25px;">
                                    <td> </td>
                                    <td></td>
                                    <td colspan="2" style="border-left:1px solid black;border-top:1px solid black;border-right:1px solid black;"><label style="margin-left:5px;"><b>Add @Model.TaxDescription % GST on * @Model.TotalAmount </b></label></td>
                                    <td style="border-top:1px solid black;text-align:right;margin-right:5px;"><label style="margin-right:5px;"> @Model.TaxAmount</label></td>
                                </tr>
                                <tr style="height:25px;">
                                    <td> </td>
                                    <td></td>
                                    <td colspan="2" style="border-left:1px solid black;border-top:1px solid black;border-right:1px solid black;"><label style="margin-left:5px;"><b>Total Non Taxable Amount </b></label></td>
                                    <td style="border-top:1px solid black;text-align:right;margin-right:5px;"><label style="margin-right:5px;">@Model.TotalNonTaxableAmount</label></td>
                                </tr>
                                <tr style="height:25px;">
                                    <td> </td>
                                    <td></td>
                                    <td colspan="2" style="border-left:1px solid black;border-top:1px solid black;border-right:1px solid black;"><label style="margin-left:5px;"><b>Grand Total </b></label></td>
                                    <td style="border-top:1px solid black;text-align:right;"><label style="margin-right:5px;"> @Model.GrandTotal</label></td>
                                </tr>
                            }
                            else
                            {
                                <tr style="height:25px;">
                                    <td style="border-top:1px solid black;"> </td>
                                    <td style="border-top:1px solid black;"></td>
                                    <td colspan="2" style="border-left:1px solid black;border-top:1px solid black;border-right:1px solid black;"><label style="margin-left:5px;"><b>Grand Total</b></label></td>
                                    <td style="border-top:1px solid black;text-align:right;margin-right:5px;"><label style="margin-right:5px;"> @Model.GetGrandTotalWithoutTax()</label></td>
                                </tr>
                            }
                        }
                    </tbody>
                </table>
                <div style="width:690px;text-align:center;padding-bottom:10px;font-family:Tahoma;margin-top:5px;">
                    <label style="margin-top:5px;"><b>THIS IS THE COMPUTER GENERATED PRINTOUT. NO SIGNATURE IS REQUIRED.</b></label>
                </div>
            </div>
        } while (!Model.IsLastPage);
</body>
</html>