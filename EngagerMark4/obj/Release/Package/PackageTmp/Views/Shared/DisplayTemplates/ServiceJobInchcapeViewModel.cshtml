@model EngagerMark4.ApplicationCore.SOP.ViewModels.ServiceJobInchcapeViewModel
@using EngagerMark4.Common.Configs;

@{
    int count = 0;
    int times = 0;
}

<html>
<head>
    <meta charset="utf-8" />
    <title>Service Job</title>
    <style>
        .invoice-box {
            max-width: 690px;
            margin: auto;
            border: none;
            box-shadow: 0 0 10px rgba(0, 0, 0, .15);
            font-size: 12px;
        }
    </style>
</head>

<body style="font-size:12px;font-family:Calibri;">
    <div class="invoice-box">
        <div style="margin-left:5px; text-align:center">

            <img src="@Url.Action("DownloadByReferenceIdAndType", "FileUpload", new { referenceId = Model.LetterheadId, entityType = EntityConfig.EntityType.Letterhead }, Request.Url.Scheme)" style="width:200px;" />

            @*<img src="@Url.Action("Inchcape.jpg", "Images\\Company", null, Request.Url.Scheme)" />*@
        </div>
        <table style="font-size:14px;margin-top:20px;">
            <tr>
                <td style="width:40px;text-align:left"></td>
                <td style="width:90px;text-align:left"></td>
                <td style="width:80px;text-align:left"></td>
                <td style="width:150px;text-align:left"></td>
                <td style="width:150px;text-align:left"></td>
                <td style="width:100px;text-align:left"></td>
                <td style="width:230px;text-align:left"></td>
            </tr>
            <tr style="height:20px;padding-top:20px;">
                <td colspan="7"></td>
            </tr>
            <tr style="height:30px;">
                <td style="text-align:center;border:solid thick;border-color:black;padding:10px 1px 10px 1px;font-size:18px;" colspan="3">Transfer Voucher</td>
                <td style="text-align:right;" colspan="2"></td>
                <td style="text-align:left;">
                    Vehicle Number
                </td>
                <td>
                    <div style="border-bottom:1px solid;height:12px;padding-top:0px;padding-bottom:3px;font-size:13px;">
                        : 
                    </div>
                </td>
            </tr>
            <tr style="height:30px;padding-top:20px;">
                <td>Date</td>
                <td colspan="2" style="text-align:left;">
                    <div style="border-bottom:1px solid;height:12px;padding-top:0px;padding-bottom:3px;font-size:13px;">
                        : @Model.WorkOrder.PickUpDateOnlyStr
                    </div>
                </td>
                <td colspan="2"></td>
                <td>
                    Control Number<br />
                    PO Number
                </td>
                <td>
                    <div style="border-bottom:1px solid;height:12px;padding-top:0px;padding-bottom:3px;font-size:13px;">:</div><br />
                    <div style="border-bottom:1px solid;height:12px;padding-top:0px;padding-bottom:3px;font-size:13px;">:</div>
                </td>
            </tr>
            <tr style="height:30px;padding-top:20px;">
                <td colspan="2">
                    Vessel Name
                </td>
                <td colspan="5">
                    <div style="border-bottom:1px solid;height:12px;padding-top:0px;padding-bottom:3px;font-size:13px;">
                        : @Model.WorkOrder.VesselName
                    </div>
                </td>
            </tr>
            <tr style="height:30px;padding-top:20px;">
                <td colspan="2">
                    Location From
                </td>
                <td colspan="2">
                    <div style="border-bottom:1px solid;height:12px;padding-top:0px;padding-bottom:3px;font-size:13px;">
                        : @Model.WorkOrder.GetPickUpPoint()
                    </div>
                </td>
                <td></td>
                <td>
                    To
                </td>
                <td>
                    <div style="border-bottom:1px solid;height:12px;padding-top:0px;padding-bottom:3px;font-size:13px;">
                        : @Model.WorkOrder.DropPoint
                    </div>
                </td>
            </tr>
            <tr style="height:30px;padding-top:20px;">
                <td colspan="2">
                    Time From
                </td>
                <td colspan="2">
                    <div style="border-bottom:1px solid;height:12px;padding-top:0px;padding-bottom:3px;font-size:13px;">
                        : @Model.StartTimeStr HRS
                    </div>
                </td>
                <td></td>
                <td>
                    To
                </td>
                <td>
                    <div style="border-bottom:1px solid;height:12px;padding-top:0px;padding-bottom:3px;font-size:13px;">
                        : &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; HRS
                    </div>
                </td>
            </tr>
            <tr style="height:30px;padding-top:20px;">
                <td colspan="2">
                    Purpose of Trip
                </td>
                <td colspan="5">
                    <div style="border-bottom:1px solid;height:12px;padding-top:0px;padding-bottom:3px;font-size:13px;">
                        : @Model.WorkOrder.Description
                    </div>
                </td>
            </tr>
            <tr style="height:30px;padding-top:20px;">
                <td colspan="2">
                    Nos of Passenger(s)
                </td>
                <td colspan="1">
                    <div style="border-bottom:1px solid;height:12px;padding-top:0px;padding-bottom:3px;font-size:13px;">
                        : @Model.WorkOrder.GetNoOfPax(Model.VehicleId == null ? 0 : Model.VehicleId.Value)
                    </div>
                </td>
                <td></td>
                <td>
                    Arrival Flight details
                </td>
                <td colspan="2">
                    <div style="border-bottom:1px solid;height:12px;padding-top:0px;padding-bottom:3px;font-size:13px;">
                        : @Model.WorkOrder.GetFlightNo()
                    </div>
                </td>
            </tr>
            <tr style="height:30px;padding-top:20px;">
                <td colspan="2">
                    Remark
                </td>
                <td colspan="5">
                    <div style="border-bottom:1px solid;height:12px;padding-top:0px;padding-bottom:3px;font-size:13px;">
                        :                         
                        @if (!String.IsNullOrEmpty(Model.WorkOrder.GetAdditionalStop()))
                        {
                            <label> Stops : @Model.WorkOrder.GetAdditionalStop()</label>
                        }

                        @Model.WorkOrder.AdminRemarkInVoucher
                    </div>
                </td>
            </tr>
            <tr style="height:20px;padding-top:20px;">
                <td colspan="7"></td>
            </tr>
            <tr style="padding-top:50px;">
                <td colspan="7">
                    <table style="font-size:12px;border-collapse:collapse;">
                        <thead>
                            <tr style="border-bottom:1px solid black;border-top:1px solid black;height:25px;">
                                <td style="text-align:center;width:40px;border-right:1px solid black;border-left:1px solid black;">S/No</td>
                                <td style="text-align:center;width:250px;border-right:1px solid black;border-left:1px solid black;">Rank Or Company Name</td>
                                <td style="text-align:center;width:550px;border-right:1px solid black;border-left:1px solid black;">Passenger Name</td>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var passenger in Model.GetPassengers(Model.VehicleId))
                            {
                                count++;
                                <tr style="height:25px;">
                                    <td style="border-right:1px solid black;text-align:center;border-left:1px solid black;border-bottom:1px solid black;">
                                        @count
                                    </td>
                                    <td style="border-right:1px solid black;text-align:left;border-left:1px solid black;border-bottom:1px solid black;padding-left:4px;">
                                        @passenger.Rank
                                    </td>
                                    <td style="border-right:1px solid black;text-align:left;border-left:1px solid black;border-bottom:1px solid black;padding-left:4px;">
                                        @passenger.Name
                                    </td>
                                </tr>
                            }

                            @{
                                times = 9 - count;
                            }

                            @for (int i = 0; i < times; i++)
                            {
                                count = count + 1;
                                <tr style="height:25px;font-size:12px;">
                                    <td style="border-right:1px solid black;text-align:center;border-left:1px solid black;border-bottom:1px solid black;">

                                        @count
                                    </td>
                                    <td style="border-right:1px solid black;text-align:left;border-left:1px solid black;border-bottom:1px solid black;padding-left:4px;"></td>
                                    <td style="border-right:1px solid black;text-align:left;border-left:1px solid black;border-bottom:1px solid black;padding-left:4px;"></td>
                                </tr>
                            }

                        </tbody>
                    </table>
                </td>
            </tr>
            <tr style="height:10px;padding-top:20px;">
                <td colspan="7"></td>
            </tr>
            <tr style="height:20px;padding-top:20px;">
                <td colspan="3">
                    Billing Purposes Only :
                </td>
                <td colspan="5"></td>
            </tr>
            <tr style="padding-top:30px;">
                <td colspan="4">
                    <table style="font-size:12px;border-collapse:collapse;">
                        <thead>
                            <tr style="border-bottom:1px solid black;border-top:1px solid black;height:25px;">
                                <td style="text-align:center;width:180px;border-right:1px solid black;border-left:1px solid black;">Description Of Charges</td>
                                <td style="text-align:center;width:180px;border-right:1px solid black;border-left:1px solid black;">Singapore Dollar</td>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="height:25px;">
                                <td style="border-right:1px solid black;text-align:left;border-left:1px solid black;border-bottom:1px solid black;padding-left:4px;">
                                    Basic Transfer Rate
                                </td>
                                <td style="border-right:1px solid black;text-align:left;border-left:1px solid black;border-bottom:1px solid black;padding-left:4px;"></td>
                            </tr>
                            <tr style="height:25px;">
                                <td style="border-right:1px solid black;text-align:left;border-left:1px solid black;border-bottom:1px solid black;padding-left:4px;">
                                    Meet &amp; Greet Service
                                </td>
                                <td style="border-right:1px solid black;text-align:left;border-left:1px solid black;border-bottom:1px solid black;padding-left:4px;"></td>
                            </tr>
                            <tr style="height:25px;">
                                <td style="border-right:1px solid black;text-align:left;border-left:1px solid black;border-bottom:1px solid black;padding-left:4px;">
                                    Additional Stop-Over
                                </td>
                                <td style="border-right:1px solid black;text-align:left;border-left:1px solid black;border-bottom:1px solid black;padding-left:4px;"></td>
                            </tr>
                            <tr style="height:25px;">
                                <td style="border-right:1px solid black;text-align:left;border-left:1px solid black;border-bottom:1px solid black;padding-left:4px;">
                                    Disposal(Min 3 hours)
                                </td>
                                <td style="border-right:1px solid black;text-align:left;border-left:1px solid black;border-bottom:1px solid black;padding-left:4px;"></td>
                            </tr>
                            <tr style="height:25px;">
                                <td style="border-right:1px solid black;text-align:left;border-left:1px solid black;border-bottom:1px solid black;padding-left:4px;">
                                    Luggage Van
                                </td>
                                <td style="border-right:1px solid black;text-align:left;border-left:1px solid black;border-bottom:1px solid black;padding-left:4px;"></td>
                            </tr>
                            <tr style="height:25px;">
                                <td style="border-right:1px solid black;text-align:left;border-left:1px solid black;border-bottom:1px solid black;padding-left:4px;">
                                    Other Expenses :
                                </td>
                                <td style="border-right:1px solid black;text-align:left;border-left:1px solid black;border-bottom:1px solid black;padding-left:4px;"></td>
                            </tr>
                            <tr style="height:25px;">
                                <td style="border-right:1px solid black;text-align:left;border-left:1px solid black;border-bottom:1px solid black;padding-left:4px;">
                                    Total Charges :
                                </td>
                                <td style="border-right:1px solid black;text-align:left;border-left:1px solid black;border-bottom:1px solid black;padding-left:4px;"></td>
                            </tr>
                        </tbody>
                    </table>
                </td>
                <td colspan="3">
                    <table style="font-size:12px;padding-left:20px;">
                        <tr>
                            <td width="330px;"></td>
                        </tr>
                        <tr style="height:70px;text-align:center;">
                            <td style="vertical-align:central;">
                                @if (Model.SignatureId == 0)
                                {
                                    <img src="@Url.Action("DownloadByReferenceIdAndType", "FileUpload", new { referenceId= Model.WorkOrder.GetPassengerInChargeId(Model.VehicleId == null ? 0 : Model.VehicleId.Value), entityType = EntityConfig.EntityType.ServiceJobSignature }, Request.Url.Scheme)" style="height:70px;width:150px;" />
                                }
                                else
                                {
                                    <img src="@Url.Action("Download", "FileUpload", new { id= Model.SignatureId }, Request.Url.Scheme)" style="height:70px;width:150px;" />
                                }
                            </td>
                        </tr>
                        <tr style="height:60px;">
                            <td>
                                <div style="border-top:1px solid;height:12px;padding-top:0px;padding-bottom:3px;font-size:12px;text-align:center;">
                                    Authorised Signature
                                </div>
                            </td>
                        </tr>
                        <tr style="height:10px;">
                            <td>
                                <div style="height:13px;padding-top:0px; padding-bottom:0px;font-size:14px;text-align:center">
                                    @Model.WorkOrder.GetPassengerInCharge(Model.VehicleId == null ? 0 : Model.VehicleId.Value) / @Model.WorkOrder.GetPassengerInChargeRank(Model.VehicleId == null ? 0 : Model.VehicleId.Value)
                                </div>
                            </td>
                        </tr>
                        <tr style="height:60px;">
                            <td>
                                <div style="border-top:1px solid;height:12px;padding-top:0px;padding-bottom:3px;font-size:12px;text-align:center;">
                                    (Name / Rank or Company Name)
                                </div>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr style="height:10px;padding-top:20px;">
                <td colspan="7"></td>
            </tr>
            <tr style="height:10px;padding-top:20px;text-align:center;font-size:11px;">
                <td colspan="7">
                    Inchcape Shipping Services (S) Pte Ltd, 10 Hoe Chiang Road, #20-01/02 Keppel Towers, Singapore 089315
                </td>
            </tr>
            <tr style="height:10px;padding-top:20px;text-align:center;font-size:11px;">
                <td colspan="7">
                    Tel: +65 6412 2900 Fax: +65 6412 2958 Email : Operations.sg@iss-shipping.com
                </td>
            </tr>
            <tr style="height:10px;padding-top:20px;text-align:center;font-size:11px;">
                <td colspan="7">
                    https://www.ISS-shipping.com    Company Registration No. 193600042E
                </td>
            </tr>
        </table>
        @*<div style="margin-left:5px;">
                    <img src="@Url.Action(Model.FooterLogo, "Images\\Company", null, Request.Url.Scheme)" style="width:690px;height:60px;" />            </div>
            </div>*@

    </div>
</body>
</html>

